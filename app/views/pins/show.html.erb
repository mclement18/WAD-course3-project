<main class="mb-4">
  <div class="container d-flex flex-wrap mb-5">

    <div class="col-12 col-md-3 col-lg-4 order-md-2">
      <h1 class="mb-3"><%= @pin.title %></h1>
      <h3 class="h6 mb-3"><%= @pin.tag %></h3>
      <ul class="list-unstyled small text-secondary">

        <li class="d-flex flex-wrap mr-2 mr-lg-0 mb-2">
          <div class="d-flex flex-wrap mr-2 mb-1 separator">
            Created by 
            <span class="d-flex ml-1 ml-md-0 ml-lg-1 text-dark">
              <%= image_tag('avatar', atl: 'Default avatar', class: 'img-small rounded-circle mr-1') %> 
              <%= @pin.user.email %>
            </span>
          </div>
          <div class="">
            On <time datetime=<%= @pin.created_at.strftime("%FT%T") %> class="text-dark"><%= @pin.created_at.strftime("%d %b '%y") %></time>
          </div>
        </li>

        <li class="mr-2 mr-lg-0 mb-1">Pinned by <span class="text-dark">n poeple</span></li>

      </ul>

      <% if @user_logged_in %>
        <div class="w-100 btn-group mb-2" role="group">
          <%= link_to('Edit', edit_pin_path(@pin), class: 'btn btn-outline-dark w-50 text-uppercase') %>
          <%= form_tag(user_pinboard_pins_path(@user), class: 'btn btn-outline-dark w-50 p-0 no-hover') do %>
            <%= hidden_field_tag(:pin_id, @pin.id) %>
            <%= button_tag('Add', class: 'btn btn-outline-dark w-100 text-uppercase border-0 rounded-0', disabled: @disable_add_pin) %>
          <% end %>
        </div>
      <% end %>

    </div>

    <div class="col-12 col-md-8 col-lg-7 order-md-1">
      <img class="card-img" src=<%= @pin.image_url %> alt="Card image">
    </div>

  </div>

  <div class="container">

    <h2 class="mb-4">Comments <span class="h6 text-secondary">
      <% if @pin.comments.length > 1 %>
        <%= @pin.comments.length %> comments
      <% else %>
        <%= @pin.comments.length %> comment
      <% end %>
    </span></h2>

    <% if @user_logged_in %>
      <% if @comment.errors.any? %>
        <div class="row justify-content-center">
          <div class="alert alert-danger col-sm-11" role="alert">
            <%= @comment.errors.full_messages.join('<br />').html_safe %>
          </div>
        </div>
      <% end %>
      <%= form_for([@pin, @comment], html: { class: 'media mw-lg-75 mb-5' }) do |form| %>
        <%= image_tag('avatar', alt: 'Default avatar', class: 'mr-3 rounded-circle') %>
        <div class="form-group media-body">
          <%= form.label(:body, 'Add a comment') %>
          <%= form.text_area(:body, class: 'form-control mb-2', rows: 3, maxlength: 500, placeholder: 'Max 500 characters...') %>
          <%= form.submit('Post', class: 'btn btn-primary w-25') %>
        </div>
      <% end %>
    <% end %>

    <% if @pin.comments.any? %>
      <ul class="list-unstyled mw-lg-75 mb-4">
        <% @pin.comments_invert.each do |comment| %>
          <li class="media mb-4">
            <%= image_tag('avatar', alt: 'Default avatar', class: 'mr-3 rounded-circle') %>
            <div class="media-body">
              <h5 class="mt-0 mb-1"><%= comment.user.email %> <time datetime=<%= comment.created_at.strftime("%FT%T") %> class="h6 text-secondary"><%= comment.created_at.strftime("%d %b '%y") %></time></h5>
              <p>
                <%= comment.body %>
              </p>
            </div>
          </li>
        <% end %>
      </ul>
    <% end %>

  </div>
</main>